# íŒŒë¼ë¯¸í„° ì²´í¬

ì¼ë°˜ì ìœ¼ë¡œ íŒŒë¼ë¯¸í„°ëŠ” typeì„ ëª…ì‹œí•˜ê±°ë‚˜ ì´ˆê¸°ê°’ìœ¼ë¡œ ì¦‰ valueë¡œ íƒ€ìž…ì„ ì•Œ ìˆ˜ ìžˆìœ¼ë‚˜ `corpList.forEach(corp => corp.display())`ì™€ ê°™ì€ êµ¬ë¬¸ì—ì„œëŠ” íŒŒë¼ë¯¸í„°ì¸ corpì˜ íƒ€ìž…ì´ ëª…ì‹œë˜ì§€ë„ ì•Šì•˜ê³  ê°’ë„ ì•Œ ìˆ˜ ì—†ë‹¤.

ì´ëŸ° ìœ í˜•ì˜ íŒŒë¼ë¯¸í„°ì˜ íƒ€ìž…ì„ ì•Œê¸° ìœ„í•´ì„œëŠ” `forEach` í•¨ìˆ˜ì˜ ì •ì˜ì™€ `corpList`ì˜ ì •ì˜ê¹Œì§€ ê±°ìŠ¤ëŸ¬ ì˜¬ë¼ê°€ë©´ì„œ íƒ€ìž…ì„ ì¶”ë¡ í•´ì•¼ í•œë‹¤.

í˜„ìž¬ íŒŒë¼ë¯¸í„°ë“¤ì˜ íƒ€ìž… ì¶”ë¡ ì€ `inferTypeParameter()`ì—ì„œ ì²˜ë¦¬í•˜ê³  ìžˆëŠ”ë° ì´ í•¨ìˆ˜ì—ì„œ íƒ€ìž… ì¶”ë¡ ì„ í•˜ëŠ” ê²ƒì˜ ìž¥ë‹¨ì ì„ ìž ì‹œ ì‚´íŽ´ë³´ë©´

### ìž¥ì 

ìž¥ì ì´ë¼ê¸° ë³´ë‹¤ëŠ” ì—¬ê¸°ì„œ ì•ˆí•˜ë©´ ì•ˆë˜ëŠ” ì´ìœ ê°€ ìžˆë‹¤.

`inferTypeParameter()`ì—ì„œ íŒŒë¼ë¯¸í„°ì— ëŒ€í•œ deepí•œ íƒ€ìž… ì¶”ë¡ ì„ í•˜ì§€ ì•Šê³ (íƒ€ìž…ì´ ëª…ì‹œë˜ì–´ì ¸ ìžˆê±°ë‚˜ í•´ì„œ ì‰½ê²Œ í™•ì¸í•  ìˆ˜ ìžˆëŠ” ê²½ìš°ë§Œ ì²˜ë¦¬í•˜ê³  ëª¨ë¥´ëŠ” ê²½ìš°ì—ëŠ” any typeì„ ë¦¬í„´í•˜ê²Œ í•˜ëŠ” ë“±) ì •í™•í•˜ê³  ì„¸ë°€í•œ íŒŒë¼ë¯¸í„°ì˜ íƒ€ìž… ê²€ì‚¬ëŠ” Validatorì—ì„œ ê²€ì‚¬í•˜ê²Œ í•  ìˆ˜ë„ ìžˆë‹¤.

ê·¸ëŸ°ë° ì´ë ‡ê²Œ í•˜ë©´ `firmList.forEach(e => { r.push(e.firms.toString()) })` ì´ëŸ° êµ¬ë¬¸ì—ì„œ `e` ë‹¤ìŒì˜ `firms`ê°€ ì œëŒ€ë¡œ ì„¤ì •ë˜ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ìƒê¸´ë‹¤. `toString`, `firms`ë¥¼ ê±°ì³ `e`ì˜ scopeë¥¼ ê³„ì‚°í•  ë•Œ `e`ì˜ íƒ€ìž…ì´ anyë¡œ ì„¤ì •ë˜ì–´ì ¸ ìžˆìœ¼ë©´ `firms`ëŠ” ë‹¨ìˆœížˆ ì´ë¦„ë§Œ ì¡´ìž¬í•˜ê²Œ ë˜ê³  `e.firms`ê°€ ì˜¬ë°”ë¥¸ ê²ƒì¸ì§€ ì²˜ë¦¬í•  ìˆ˜ ì—†ê²Œ ëœë‹¤. `firms`ê°€ astìƒì—ì„œ ì œëŒ€ë¡œ ì„¤ì •ì´ ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— `toString`ë„ ë¬¸ì œê°€ ëœë‹¤. ì¦‰ íŒŒë¼ë¯¸í„°ì˜ íƒ€ìž…ì„ scope ë‹¨ê³„ì—ì„œ ì ì ˆížˆ ì œê³µí•´ ì£¼ì§€ ëª»í•˜ë©´ `firms`ì™€ ê°™ì€ í”„ë¡œí¼í‹°ì˜ ì„¤ì •ì´ ì œëŒ€ë¡œ ì´ë¤„ì§ˆ ìˆ˜ ì—†ëŠ” ê²ƒì´ë‹¤. ì´ ê³¼ì •ì€ Languiumì˜ DocumentBuilderì—ì„œë„ ì´ë¤„ì§ˆ ìˆ˜ ìžˆëŠ”ë° validatorë¥¼ ì´ìš©í•œ ì²˜ë¦¬ëŠ” ì´ ê³¼ì • ì´í›„ì— ì²˜ë¦¬ë˜ê¸° ë•Œë¬¸ì— ë„ˆë¬´ ëŠ¦ë‹¤.

ë˜ `e`ê°€ ì“°ì´ëŠ” ëª¨ë“  ê³³ì—ì„œ ì´ë¯¸ any íƒ€ìž…ìœ¼ë¡œ ì¸ì‹í•˜ê¸° ë•Œë¬¸ì— ë‚˜ì¤‘ì— ì´ë¥¼ ëª¨ë‘ ë³´ì •í•´ ì¤˜ì•¼ í•˜ëŠ” ë¬¸ì œë„ ìžˆì„ ìˆ˜ ìžˆë‹¤.

### ë‹¨ì 

ê·¸ëž˜ì„œ íŒŒë¼ë¯¸í„°ì˜ íƒ€ìž… ì¶”ë¡ ì„ `inferTypeParameter()`ì—ì„œ ì²˜ë¦¬í•˜ê²Œ ë˜ë©´ ê°€ìž¥ í° ë¬¸ì œëŠ” ìž¬ê·€ ì°¸ì¡° ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìžˆë‹¤ëŠ” ê²ƒì´ë‹¤.

íŒŒë¼ë¯¸í„°ì˜ íƒ€ìž…ì„ ì•Œê¸° ìœ„í•´ì„œëŠ” í•¨ìˆ˜ì˜ íƒ€ìž…ì„ ì¶”ë¡ í• ë•Œ ë‹¤ì‹œ ë™ì¼í•œ íƒ€ìž…ì„ ì•Œì•„ì•¼ í•˜ëŠ” ì¦‰ `inferTypeParameter > inferType(node.value) > inferTypeFunctionValue() > inferTypeParameter`ìœ¼ë¡œ ì´ì–´ì§€ëŠ” ìˆœí™˜ ê³ ë¦¬ê°€ ì¡´ìž¬í•˜ê²Œ ëœë‹¤.

ì—„ë°€í•˜ê²Œ ë§í•˜ìžë©´ íŒŒë¼ë¯¸í„° íƒ€ìž… ì¶”ë¡ ì´ ì–´ë–¤ ê²ƒì˜ íƒ€ìž… ì¶”ë¡  ê³¼ì •ì˜ ì¤‘ê°„ì— ìžˆê¸° ë•Œë¬¸ì´ë‹¤. ì´ ì¶”ë¡  ê³¼ì •ì´ ë‚´ê°€ ì¶”ë¡ í•˜ë ¤ëŠ” í•¨ìˆ˜ì™€ ê´€ë ¨ì´ ì—†ìœ¼ë©´ ìƒê´€ì—†ì§€ë§Œ ê´€ë ¨ì´ ìžˆìœ¼ë©´ íŒŒë¼ë¯¸í„° íƒ€ìž… ì¶”ë¡ ì„ í•˜ë©´ì„œ ì¶”ë¡  ì¤‘ì´ë˜ í•¨ìˆ˜ì— ëŒ€í•´ì„œ ë‹¤ì‹œ ì°¸ì¡°í•˜ë ¤ í•˜ë©´ ë°œìƒë˜ëŠ” ê²ƒì´ë‹¤. í•­ìƒ ê·¸ëŸ° ê²ƒë„ ì•„ë‹ˆì§€ë§Œ ë¹ˆë²ˆí•˜ê²Œ ë°œìƒí•˜ë©° ì¶”ë¡  ê³¼ì •ì´ ë³µìž¡í•˜ë©´ ë³µìž¡í• ìˆ˜ë¡ ë°œìƒë  í™•ë¥ ì´ ë” ë†’ì•„ì§„ë‹¤.

ì´ ë¬¸ì œëŠ” ì¶”ë¡ ì‹œ ì‚¬ìš©í•˜ëŠ” cacheë¥¼ ìƒˆë¡œ í• ë‹¹í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ í•´ê²°í•˜ì˜€ë‹¤.
íŒŒë¼ë¯¸í„°ë¡œ ì‹œìž‘í•´ì„œ í•¨ìˆ˜ë“¤ì„ ê±°ì³ íŒŒë¼ë¯¸í„°ì˜ íƒ€ìž…ì„ ì¶”ë¡ í•˜ëŠ” ê³¼ì • ìžì²´ëŠ” ìˆœí™˜ì ì´ì§€ ì•Šì„ ìˆ˜ ìžˆëŠ”ë° ì´ ê³¼ì •ì„ ì²˜ìŒë¶€í„° ì œì–´í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ë°œìƒí•œ ë¬¸ì œë¼ê³  í•  ìˆ˜ ìžˆë‹¤. ê·¸ëž˜ì„œ ì¶”ë¡  ê³¼ì •ì—ì„œ ì‚¬ìš©í•˜ëŠ” cacheë¥¼ íŒŒë¼ë¯¸í„°ë¥¼ ì¶”ë¡ í•  ë•Œê¹Œì§€ëŠ” ìž„ì‹œì˜ cacheë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ recursive definitionì„ ì²˜ë¦¬í•˜ì˜€ë‹¤.

### ì²˜ë¦¬ê³¼ì •

íŒŒë¼ë¯¸í„°ì˜ íƒ€ìž…ì„ ì¶”ë¡ í•˜ê¸° ìœ„í•´ì„œëŠ” ê·¸ íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©ë˜ëŠ” í•¨ìˆ˜ë¥¼ ì°¾ì•„ì•¼ í•œë‹¤. íŒŒë¼ë¯¸í„°ì˜ íƒ€ìž… ì¶”ë¡ ì—ëŠ” íŒŒë¼ë¯¸í„°ë¥¼ ê°€ì§€ê³  ìžˆëŠ” í•¨ìˆ˜ê°€ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤. ì´ í•¨ìˆ˜ê°€ ê²°êµ­ì€ íŒŒë¼ë¯¸í„°ì˜ íƒ€ìž…ì„ ì¢Œìš°í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

ì´ í•¨ìˆ˜ë¥¼ ì°¾ê¸° ìœ„í•´ì„œ Parameterì˜ Containerë¥¼ ì‚¬ìš©í•œë‹¤.   
`node.$type`ì´ Parameterì´ë©´ `node.$container.$type`ëŠ”
FunctionDef, FunctionValue, FunctionTypeì´ ë  ìˆ˜ ìžˆê³  ë‹¤ì‹œ ê·¸ê²ƒì˜ containerëŠ” í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ë¶€ë¶„ì´ ëœë‹¤.  
ì¦‰ ë‹¤ìŒê³¼ ê°™ë‹¤.

í•¨ìˆ˜í˜• ë©”ì„œë“œì¸ `corpList.forEach(corp => corp.display())` ì˜ ê²½ìš°
|   |   |   |
|---|---|---|
| `node`                       | Parameter     | `corp` |
| `node.$container`            | FunctionValue | `corp => corp.process()` |
| `node.$container.$container` | CallChain     | `corpList.forEach(corp => corp.process())` |

ì¼ë°˜ í•¨ìˆ˜ í˜¸ì¶œì¸ ê²½ìš°
```ts
val getSaleDetail = (date: number, callback: (salesDetail: SalesDetail) => string) => { }
getSaleDetail(12, salesDetail => { return salesDetail.salesHistory })
```
|   |   |   |
|---|---|---|
| `node`                       | Parameter     | `salesDetail` |
| `node.$container`            | FunctionValue | `salesDetail => { return salesDetail.salesHistory }` |
| `node.$container.$container` | CallChain     | `getSaleDetail(12, salesDetail => { return salesDetail.salesHistory })` |

ì´ë ‡ê²Œ ì°¾ì€ í•¨ìˆ˜ê°€ ì–´ë–¤ íƒ€ìž…ì¸ê°€ë¥¼ ì¶”ë¡ í•´ì•¼ í•˜ëŠ”ë° ì´ê²ƒì€ ì´ í•¨ìˆ˜ì˜ ì´ì „ ë¶€ë¶„ì´ ë¬´ì—‡ì¸ì§€ì™€ ê´€ë ¨ì´ ìžˆë‹¤. ì¦‰ `corpList.forEach`ì—ì„œ `corpList`ê°€ ë¬´ì—‡ì¸ì§€ë„ ì•Œì•„ì•¼ í•œë‹¤ëŠ” ê²ƒì´ë‹¤. ì´ chainì€ ê½¤ ê±°ìŠ¬ëŸ¬ ì˜¬ë¼ê°ˆ ìˆ˜ë„ ìžˆë‹¤.

ì–´ì§¸ë“  ì´ ê³¼ì •ì„ ê±°ì³ì„œ í•¨ìˆ˜ì˜ íƒ€ìž…ì„ ì•Œì•„ë‚¼ ë•Œ í•´ë‹¹ í•¨ìˆ˜ì˜ ì œë„¤ë¦­ ì •ë³´ë„ ê³ ë ¤ë˜ì–´ì•¼ í•œë‹¤. 

ë§ˆì§€ë§‰ìœ¼ë¡œ í•´ë‹¹ í•¨ìˆ˜ì˜ ì •í™•í•œ íƒ€ìž…ì„ ì°¾ì•˜ë‹¤ë©´ íŒŒë¼ë¯¸í„°ì˜ íƒ€ìž…ë„ ì•Œìˆ˜ ìžˆëŠ”ë° ë¬¸ì œëŠ” salesDetailê³¼ ê°™ì€ íŒŒë¼ë¯¸í„°ê°€ í•¨ìˆ˜ì˜ ëª‡ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì¸ê°€ë¥¼ í‰ê°€í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ë‹¤. `inferTypeParameter()`ì˜ ì •ë³´ë¡œëŠ” ì´ê²ƒì„ ì•Œ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ë‹¤ì‹œ í•¨ìˆ˜ì—ì„œ ìžì‹ ì˜ íŒŒë¼ë¯¸í„°ê°€ ëª‡ë²ˆì§¸ ì¸ì§€ë¥¼ ë³´ê³  í•¨ìˆ˜ì˜ íŒŒë¼ë¯¸í„° ì •ë³´ì™€ ë§¤ì¹˜í•´ì„œ ìžì‹ ì˜ ì‹¤ì œ íƒ€ìž…ì„ ê²°ì •í•˜ê²Œ ëœë‹¤.

ì´ë¥¼ ìœ„í•´ì„œ CallChainì˜ argsë¥¼ ì‚¬ìš©í•´ì„œ íŒŒë¼ë¯¸í„°ì˜ ìœ„ì¹˜ë¥¼ í•˜ë‚˜ì”© ë‹¤ ê²€í† í•œë‹¤.

ìžì„¸í•œ ê²ƒì€ ì½”ë“œê°€ ìžì„¸í•˜ê²Œ ì„¤ëª…í•˜ê³  ìžˆë‹¤.

```ts
def Corp = {
  val process = () => {
    console.log('process')
  }
}
val corps: Corp[] = []
corps.forEach(corp => corp.process())
```

```
Type of variable 'process' is () -> void
Type of function '() => {
    console.log('process')
  }' is () -> void
ðŸš€ ~ checkCallChain: Type of function 'log' is (args: any[]) -> void
Type of variable 'corps' is Corp[]
ðŸš€ ~ checkCallChain: Type of function 'forEach' is (callbackFn: (arg: Corp, index: number) -> any, thisArg: any) -> void
Type of function 'corp => corp.process()' is (corp: Corp) -> void
ðŸš€ ~ checkCallChain: Type of function 'process' is () -> void
```

ì•„ëž˜ì˜ ì½”ë“œëŠ” Bindingì— ëžŒë‹¤ í•¨ìˆ˜ê°€ í¬í•¨ë˜ëŠ” ê²½ìš°ì¸ë° Bindingì€ ì¢€ ë” ì‚´íŽ´ë´ì•¼ í•œë‹¤.

```ts
case 'ê´‘ì‚°' => {
  val nextChain: ChainPrompt = {
    prompt: promptMsg
    createListCallback: (list, options) => {
      return createRsrcList(Rsrc.getRsrcsList(['ì±„ê´‘ì§€']), list)
    }
  }
  return nextChain
}
case 'ë²Œëª©' => {
  val nextChain: ChainPrompt = {
    prompt: promptMsg
    createListCallback: (list, options) => {
      return createRsrcList(Rsrc.getRsrcsList(['ë²Œëª©ì§€']), list)
    }
  }
  return nextChain
}
```
